function GetUrlRelativePath(){var e=document.location.toString().split("//"),n=e[1].indexOf("/"),t=e[1].substring(n);return-1!=t.indexOf("?")&&(t=t.split("?")[0]),t.split("#")[0]}function setCount(){var e=[],n=[],t=[];const a=new AV.Query("dianzan");a.limit(1e3),a.find().then((a=>{for(i=a.length-1;i>=0;i--)e.push(a[i].attributes.count),n.push(a[i].attributes.href),t.push(a[i].id);index=n.indexOf(GetUrlRelativePath()),console.log(e[index]),void 0===e[index]?document.getElementsByClassName("dianzan-count")[0].innerText="1":document.getElementsByClassName("dianzan-count")[0].innerText=e[index]+1}))}function dianzan(){try{var e=[],n=[],t=[];const a=new AV.Query("dianzan");a.limit(1e3),a.find().then((o=>{for(i=o.length-1;i>=0;i--)e.push(o[i].attributes.count),n.push(o[i].attributes.href),t.push(o[i].id);if(console.log(n),-1==n.indexOf(GetUrlRelativePath())){console.log(1);const e=new(AV.Object.extend("dianzan"));e.set("href",GetUrlRelativePath()),e.set("count",1),e.save()}else index=n.indexOf(GetUrlRelativePath()),console.log(t[index]),a.get(t[index]).then((n=>{n.set("count",e[index]+1),n.save()}));setCount()}))}catch(e){const n=new(AV.Object.extend("dianzan"));n.set("href",GetUrlRelativePath()),n.set("count",1),n.save()}}loadDianzan=function(){const{Query:e,User:n}=AV;AV.init({appId:"IvW3T1NjMoh7OmKEdAz1tM0o-gzGzoHsz",appKey:"vG8s9ukVO5bgozEHzR923dew",serverURL:"https://ivw3t1nj.lc-cn-n1-shared.com"});var t=[],a=[],o=[];const s=new AV.Query("dianzan");s.limit(1e3),s.find().then((e=>{for(i=e.length-1;i>=0;i--)t.push(e[i].attributes.count),a.push(e[i].attributes.href),o.push(e[i].id);index=a.indexOf(GetUrlRelativePath()),console.log(a),console.log(index),console.log(t[index]),void 0===t[index]?document.getElementsByClassName("dianzan-count")[0].innerText="0":document.getElementsByClassName("dianzan-count")[0].innerText=t[index]}))},document.addEventListener("DOMContentLoaded",loadDianzan),document.addEventListener("pjax:complete",loadDianzan);